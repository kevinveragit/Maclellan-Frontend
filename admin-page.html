<!DOCTYPE html><!--  This site was created in Webflow. https://webflow.com  --><!--  Last Published: Fri Sep 13 2024 01:42:22 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="65f1d2d24fccf22237e0359e" data-wf-site="65ef6a9d933d09fb8c604750">
<head>
  <meta charset="utf-8">
  <title>Admin Page</title>
  <meta content="Admin Page" property="og:title">
  <meta content="Admin Page" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/maclellan-family.webflow.css" rel="stylesheet" type="text/css">
  <style>@media (max-width:991px) and (min-width:768px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cb"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374180"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374142"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cc"] {width:100%;opacity:1;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cd"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740a7"] {display:none;opacity:0;}}@media (max-width:767px) and (min-width:480px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cb"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374180"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374142"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cc"] {width:100%;opacity:1;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cd"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740a7"] {display:none;opacity:0;}}@media (max-width:479px) {html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cb"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374180"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a374142"] {opacity:0;display:none;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cc"] {width:100%;opacity:1;}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cd"] {-webkit-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-moz-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);-ms-transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);transform:translate3d(0, 0px, 0) scale3d(1, 1, 1) rotateX(0) rotateY(0) rotateZ(0deg) skew(0, 0);}html.w-mod-js:not(.w-mod-ix) [data-w-id="5d6164c5-01f1-69e0-4884-55763a3740a7"] {display:none;opacity:0;}}</style>
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script>
  <script type="text/javascript">WebFont.load({  google: {    families: ["Changa One:400,400italic","Varela Round:400","Great Vibes:400","Exo:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic"]  }});</script>
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon"><!--  FIREBASE CODE  -->
  <!--  MADE BY WEBREND, KEVIN VERA  -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/dropbox.js/10.15.0/Dropbox-sdk.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script type="module">
// Import the functions you need from the SDKs you need
import { auth, db, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://maclellan-family-website.s3.us-east-2.amazonaws.com/firebase-init.js';
import { refreshDropboxAccessToken, createDropboxInstance, getDropboxInstance, accessToken } from 'https://maclellan-family-website.s3.us-east-2.amazonaws.com/dropbox-auth.js';
import { query, getDocs, collection, where } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";
import { getUserCount, updateTotalFileCount } from 'https://maclellan-family-website.s3.us-east-2.amazonaws.com/usercount.js';
let cursor = null;
// Handle sign-up
async function handleSignUp(e) {
    e.preventDefault();
    e.stopPropagation();
    const name = document.getElementById('signup-name').value;
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-password').value;
    console.log("Name is " + name);
    console.log("Email is " + email);
    try {
        const userCount = await getUserCount();
        if (userCount >= 6) {
            const errorText = document.getElementById('signup-error-message');
            errorText.innerHTML = "User limit reached. No more sign-ups allowed.";
            return;
        }
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        const uniqueKey = generateUniqueKey();
        console.log('User successfully created: ' + user.email);
        const folderPath = `/${name}`;
        console.log(`Creating folder in Dropbox at path: ${folderPath}`);
        const dbx = await getDropboxInstance();
        try {
            const createFolderResponse = await dbx.filesCreateFolderV2({ path: folderPath });
            console.log('Folder created in Dropbox for user:', createFolderResponse);
        } catch (dropboxError) {
            if (dropboxError.response) {
                const errorText = await dropboxError.response.text();
                console.error('Dropbox folder creation failed:', errorText);
            } else {
                console.error('Dropbox folder creation failed:', dropboxError);
            }
            throw dropboxError;
        }
        await setDoc(doc(db, "users", user.uid), {
            uid: user.uid,
            name: name,
            email: user.email,
            role: 'user',
            content: `This is the personalized content for ${email}. Your unique key is ${uniqueKey}.`,
            folderPath: folderPath
        });
        console.log('User document created with content and folder path.');
        location.reload();
    } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        const errorText = document.getElementById('signup-error-message');
        console.log('Error during sign-up:', errorMessage);
        errorText.innerHTML = errorMessage;
    }
}
// Handle sign-in
async function handleSignIn(e) {
    e.preventDefault();
    e.stopPropagation();
    const email = document.getElementById('signin-email').value;
    const password = document.getElementById('signin-password').value;
    try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;
        console.log('User logged in: ' + user.email);
        const userDoc = await getDoc(doc(db, "users", user.uid));
        if (userDoc.exists()) {
            const userData = userDoc.data();
            console.log(`User document data: ${JSON.stringify(userData)}`);
            const dbx = await getDropboxInstance();
            console.log('Calling your folder from handleSignIn');
            await fetchAndDisplayUserDropboxFolder(userData.folderPath, dbx);
            await updateFileCount(userData.folderPath, dbx);
            await updateTotalFileCount(dbx);
            await displayAllUsers(); // Display all users for admin
            location.reload();
        } else {
            console.log("No such document!");
        }
    } catch (error) {
        const errorCode = error.code;
        const errorMessage = error.message;
        const errorText = document.getElementById('signin-error-message');
        console.log('Error during sign-in:', errorMessage);
        errorText.innerHTML = errorMessage;
    }
}
// Handle sign-out
function handleSignOut() {
  signOut(auth).then(() => {
    // Refreshes the current page
    window.location.reload();
    console.log('User signed out');
  }).catch((error) => {
    console.log(error.message);
  });
}
// removes an admin based on input
async function handleRemoveAdmin(e) {
    e.preventDefault();
    e.stopPropagation();
    const email = document.getElementById('remove-admin-email').value;
    try {
        const userQuery = query(collection(db, "users"), where("email", "==", email));
        const querySnapshot = await getDocs(userQuery);
        if (querySnapshot.empty) {
            const errorText = document.getElementById('remove-admin-error-message');
            errorText.innerHTML = "User not found.";
            return;
        }
        const userDoc = querySnapshot.docs[0];
        await updateDoc(userDoc.ref, {
            role: 'user'
        });
        console.log('User role updated to user: ' + email);
    } catch (error) {
        const errorMessage = error.message;
        const errorText = document.getElementById('remove-admin-error-message');
        console.log('Error during role removal:', errorMessage);
        errorText.innerHTML = errorMessage;
    }
}
// handle delete user
async function handleDeleteUser(e, uid) {
    e.preventDefault();
    e.stopPropagation();
    try {
        const userDocRef = doc(db, "users", uid);
        const userDoc = await getDoc(userDocRef);
        if (userDoc.exists()) {
            await deleteDoc(userDocRef);
            console.log('User document deleted from Firestore.');
        }
        const user = auth.currentUser;
        if (user && user.uid === uid) {
            await deleteUser(user);
        } else {
            const userCredential = await signInWithEmailAndPassword(auth, userDoc.data().email, "dummy-password");
            await deleteUser(userCredential.user);
        }
        await displayAllUsers(); // Refresh the user list after deletion
    } catch (error) {
        const errorMessage = error.message;
        console.log('Error during user deletion:', errorMessage);
    }
}
//handles assignment of admins
async function handleAssignAdmin(e) {
    e.preventDefault();
    e.stopPropagation();
    const email = document.getElementById('assign-admin-email').value;
    try {
        const userQuery = query(collection(db, "users"), where("email", "==", email));
        const querySnapshot = await getDocs(userQuery);
        if (querySnapshot.empty) {
            const errorText = document.getElementById('assign-admin-error-message');
            errorText.innerHTML = "User not found.";
            return;
        }
        const userDoc = querySnapshot.docs[0];
        await updateDoc(userDoc.ref, {
            role: 'admin'
        });
        console.log('User role updated to admin: ' + email);
    } catch (error) {
        const errorMessage = error.message;
        const errorText = document.getElementById('assign-admin-error-message');
        console.log('Error during role assignment:', errorMessage);
        errorText.innerHTML = errorMessage;
    }
}
// handles changing your email
async function handleChangeEmail(e) {
    e.preventDefault();
    e.stopPropagation();
    const currentPasswordForEmailChange = document.getElementById('current-password-email-change').value;
    const newEmail = document.getElementById('new-email').value;
    const user = auth.currentUser;
    const changeEmailMessage = document.getElementById('change-email-message');
    if (user) {
        const credential = EmailAuthProvider.credential(user.email, currentPasswordForEmailChange);
        try {
            console.log('Reauthenticating user...');
            await reauthenticateWithCredential(user, credential);
            console.log('Reauthentication successful. Updating email...');
            await updateEmail(user, newEmail);
            console.log('Email updated in Firebase Auth.');
            // Send verification email
            await sendEmailVerification(user);
            console.log('Verification email sent.');
            // Update the Firestore user document
            const userDocRef = doc(db, "users", user.uid);
            await updateDoc(userDocRef, {
                email: newEmail
            });
            console.log('Email updated in Firestore.');
            changeEmailMessage.style.color = "green";
            changeEmailMessage.innerHTML = "Email successfully updated. Please check your inbox to verify your new email.";
        } catch (error) {
            console.log('Error during email change:', error.message);
            changeEmailMessage.innerHTML = error.message;
        }
    } else {
        changeEmailMessage.innerHTML = "No user is currently signed in.";
    }
}
// changes pass based on current password
async function handleChangePassword(e) {
    e.preventDefault();
    e.stopPropagation();
    const currentPassword = document.getElementById('current-password').value;
    const newPassword = document.getElementById('new-password').value;
    const user = auth.currentUser;
    const changePasswordMessage = document.getElementById('change-password-message');
    if (user) {
        const credential = EmailAuthProvider.credential(user.email, currentPassword);
        try {
            await reauthenticateWithCredential(user, credential);
            await updatePassword(user, newPassword);
            changePasswordMessage.style.color = "green";
            changePasswordMessage.innerHTML = "Password successfully updated.";
        } catch (error) {
            console.log('Error during password change:', error.message);
            changePasswordMessage.innerHTML = error.message;
        }
    } else {
        changePasswordMessage.innerHTML = "No user is currently signed in.";
    }
}
// handles forgottne password and emails you
async function handleForgotPassword(e) {
    e.preventDefault();
    e.stopPropagation();
    const email = document.getElementById('forgot-password-email').value;
    const forgotPasswordMessage = document.getElementById('forgot-password-message');
    try {
        await sendPasswordResetEmail(auth, email);
        forgotPasswordMessage.style.color = "green";
        forgotPasswordMessage.innerHTML = "Password reset email sent successfully. Please check your inbox.";
    } catch (error) {
        console.log('Error during password reset:', error.message);
        forgotPasswordMessage.style.color = "red";
        forgotPasswordMessage.innerHTML = error.message;
    }
}
// gets all active users
async function displayAllUsers() {
    try {
        const usersDisplayed = document.getElementById('users-displayed');
        if (!usersDisplayed) {
            console.error('Element with id "users-displayed" not found.');
            return;
        }
        usersDisplayed.innerHTML = ''; // Clear existing content
        const querySnapshot = await getDocs(collection(db, "users"));
        querySnapshot.forEach((doc) => {
            const userData = doc.data();
            const userItem = document.createElement('div');
            userItem.className = 'user-item';
            userItem.innerText = userData.name;
            const removeButton = document.createElement('button');
            removeButton.innerText = 'REMOVE';
            removeButton.onclick = (e) => handleDeleteUser(e, userData.uid);
            userItem.appendChild(removeButton);
            usersDisplayed.appendChild(userItem);
        });
    } catch (error) {
        console.error('Error fetching users:', error);
    }
}
async function fetchAndDisplayUserDropboxFolder(folderPath, dbx) {
    try {
        console.log(`Fetching contents of folder: ${folderPath}`);
        const container = document.getElementById('user-pictures-container');
        if (!container) {
            console.error('Element with id "user-pictures-container" not found.');
            return;
        }
        container.innerHTML = ''; // Clear the container before fetching new content
        const response = await dbx.filesListFolder({ path: folderPath });
        const files = response.result.entries;
        console.log('Files in folder:', files);
        if (files.length === 0) {
            console.log(`No files found in folder: ${folderPath}`);
            container.innerHTML = '<p>No files found in your folder.</p>';
            return;
        }
        files.forEach(async (file) => {
            if (file['.tag'] === 'file') {
                const fileExtension = file.name.split('.').pop().toLowerCase();
                const tempLinkResponse = await dbx.filesGetTemporaryLink({ path: file.path_lower });
                let mediaElement;
                if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                    mediaElement = document.createElement('img');
                    mediaElement.src = tempLinkResponse.result.link;
                    mediaElement.style.maxWidth = '100%';
                } else if (['mp4', 'mov', 'avi', 'mkv'].includes(fileExtension)) {
                    mediaElement = document.createElement('video');
                    mediaElement.src = tempLinkResponse.result.link;
                    mediaElement.controls = true;
                    mediaElement.style.maxWidth = '100%';
                }
                if (mediaElement) {
                    const wrapper = document.createElement('div');
                    wrapper.style.position = 'relative';
                    wrapper.style.display = 'inline-block';
                    wrapper.appendChild(mediaElement);
                    const user = auth.currentUser;
                    const userDoc = await getDoc(doc(db, "users", user.uid));
                    if (userDoc.exists() && userDoc.data().role === 'admin') {
                        const deleteButton = document.createElement('button');
                        deleteButton.innerText = 'x';
                        deleteButton.id = 'admin-button';
                        deleteButton.style.position = 'absolute';
                        deleteButton.style.top = '8px';
                        deleteButton.style.right = '8px';
                        deleteButton.style.backgroundColor = 'white';
                        deleteButton.style.color = 'grey';
                        deleteButton.style.border = 'none';
                        deleteButton.style.borderRadius = '50%';
                        deleteButton.style.cursor = 'pointer';
                        deleteButton.onclick = () => handleDeleteFile(file.path_lower);
                        wrapper.appendChild(deleteButton);
                    }
                    container.appendChild(wrapper);
                }
            }
        });
    } catch (error) {
        console.error('Error fetching folder contents:', error);
    }
}
//update file count
async function updateFileCount(folderPath, dbx) {
    try {
        const response = await dbx.filesListFolder({ path: folderPath });
        const files = response.result.entries;
        const fileCountElement = document.getElementById('file-count');
        if (fileCountElement) {
            fileCountElement.innerText = files.length;
        } else {
            console.error('Element with id "file-count" not found.');
        }
    } catch (error) {
        console.error('Error fetching file count:', error);
        const fileCountElement = document.getElementById('file-count');
        if (fileCountElement) {
            fileCountElement.innerText = 'Error fetching file count';
        }
    }
}
// Listen for authentication state changes
onAuthStateChanged(auth, async (user) => {
    // DOM Elements
    let publicElements = document.querySelectorAll("[data-onlogin='hide']");
    let privateElements = document.querySelectorAll("[data-onlogin='show']");
    let adminContents = document.getElementById('adminContents');
    let adminAccessMessage = document.getElementById('adminAccessMessage');
    let uploadButtonAdmin = document.getElementById('uploadButtonAdmin');
    let usersDisplayed = document.getElementById('users-displayed');
    if (user) {
        const uid = user.uid;
        // Show or hide elements based on authentication state
        privateElements.forEach(element => {
            element.style.display = "flex";
        });
        publicElements.forEach(element => {
            element.style.display = "none";
        });
        const userQuery = query(collection(db, "users"), where("uid", "==", uid));
        const querySnapshot = await getDocs(userQuery);
        if (!querySnapshot.empty) {
            const userDoc = querySnapshot.docs[0];
            const userData = userDoc.data();
            console.log(`User document data: ${JSON.stringify(userData)}`);
            if (userData.role === 'admin') {
                if (adminContents) {
                    adminContents.style.display = "flex";
                }
                if (adminAccessMessage) {
                    adminAccessMessage.style.display = "none";
                }
                if (uploadButtonAdmin) {
                    uploadButtonAdmin.style.display = "block";
                }
                if (usersDisplayed) {
                    usersDisplayed.style.display = "block";
                }
                await displayAllUsers(); // Display all users for admin
            } else {
                if (adminContents) {
                    adminContents.style.display = "none";
                }
                if (adminAccessMessage) {
                    adminAccessMessage.style.display = "block";
                }
                if (uploadButtonAdmin) {
                    uploadButtonAdmin.style.display = "none";
                }
                if (usersDisplayed) {
                    usersDisplayed.style.display = "none";
                }
            }
            const dbx = await getDropboxInstance();
            console.log('Calling fetchAndDisplayUserDropboxFolder from onAuthStateChanged');
            await fetchAndDisplayUserDropboxFolder(userData.folderPath, dbx);
            await updateFileCount(userData.folderPath, dbx);
            await updateTotalFileCount(dbx);
        } else {
            if (adminContents) {
                adminContents.style.display = "none";
            }
            if (adminAccessMessage) {
                adminAccessMessage.style.display = "block";
            }
            if (userDashboard) {
                userDashboard.style.display = "none";
            }
            if (uploadButtonAdmin) {
                uploadButtonAdmin.style.display = "none";
            }
            if (usersDisplayed) {
                usersDisplayed.style.display = "none";
            }
        }
        console.log(`The current user's UID is ${uid}`);
    } else {
        // If no user is signed in, adjust UI elements accordingly
        publicElements.forEach(element => {
            element.style.display = "initial";
        });
        privateElements.forEach(element => {
            element.style.display = "none";
        });
        privateElementsFlex.forEach(element => {
            element.style.display = "none";
        });
        if (adminContents) {
            adminContents.style.display = "none";
        }
        if (adminAccessMessage) {
            adminAccessMessage.style.display = "block";
        }
        if (userDashboard) {
            userDashboard.style.display = "none";
        }
        if (uploadButtonAdmin) {
            uploadButtonAdmin.style.display = "none";
        }
        if (usersDisplayed) {
            usersDisplayed.style.display = "none";
        }
    }
});
// Function to search Dropbox files and append results
async function searchDropboxFiles(startIndex = 1) {
  await refreshDropboxAccessToken(); // Ensure the access token is fresh
  let searchResults = [];
  try {
    if (!cursor) {
      // Initial search request
      const response = await fetch('https://api.dropboxapi.com/2/files/search_v2', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${accessToken}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          query: "family vacation",
          options: { max_results: 25, start: startIndex }
        })
      });
      if (response.ok) {
        const data = await response.json();
        searchResults = data.matches.map(match => match.metadata.metadata);
        cursor = data.cursor; // Save the cursor for the next request
      } else {
        console.error('Error searching Dropbox files:', response.statusText);
      }
    } else {
      // Continue from where we left off
      const response = await fetch('https://api.dropboxapi.com/2/files/search/continue_v2', {
        method: 'POST',
        headers: {
          'Authorization': `Bearer ${accessToken}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ 
            query: "family vacation", 
            cursor: cursor, 
            options: { max_results: 25, start: startIndex }
        })
      });
      if (response.ok) {
        const data = await response.json();
        searchResults = data.matches.map(match => match.metadata.metadata);
        cursor = data.cursor; // Update cursor for the next request
      } else {
        console.error('Error continuing search for Dropbox files:', response.statusText);
      }
    }
  } catch (error) {
    console.error('Error during search or continue search:', error);
  }
  return searchResults;
}
let startIndex = 1;
// Function to append search results to the DOM
async function appendResults(results) {
    const container = document.getElementById('search-results');
    for (const file of results) {
        if (startIndex >= 25) { // Stop appending after 25 elements
        appendLoadMoreButton();
        break;
        }
        if (file['.tag'] === 'file') {
            const fileExtension = file.name.split('.').pop().toLowerCase();
            let format = 'jpeg'; // Default format
            if (['png', 'heic'].includes(fileExtension)) {
                format = fileExtension; // Use png or heic if applicable
            }
            if (['jpg', 'jpeg', 'png', 'gif', 'mp4', 'mov', 'avi', 'mkv'].includes(fileExtension)) {
                try {
                const tempLinkResponse = await fetch('https://api.dropboxapi.com/2/files/get_temporary_link', {
                    method: 'POST',
                    headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ path: file.path_lower })
                });
                const thumbnailResponse = await fetch('https://content.dropboxapi.com/2/files/get_thumbnail', {
                    method: 'POST',
                    headers: {
                    'Authorization': `Bearer ${accessToken}`,
                    'Dropbox-API-Arg': JSON.stringify({
                        path: file.path_lower,
                        format: format, // Choose your desired format
                        size: 'w640h480' // Choose your desired size (e.g., 'w128h128', 'w640h480')
                    })
                    }
                });
                if (!thumbnailResponse.ok) {
                    console.error('Error getting thumbnail:', thumbnailResponse.statusText);
                    continue;
                }
                if (tempLinkResponse.ok) {
                    const tempLinkData = await tempLinkResponse.json();
                    const previewData = await thumbnailResponse.blob();
                    let previewUrl = URL.createObjectURL(previewData);  // Use preview URL if available, otherwise temp link
                    // || tempLinkData.link
                    console.log('Thumbnail size:', previewData.size); // Log the size in bytes 
                    console.log(startIndex);
                    let mediaElement;
                    if (['jpg', 'jpeg', 'png', 'gif'].includes(fileExtension)) {
                    mediaElement = document.createElement('img');
                    // mediaElement.dataset.src = tempLinkData.link;
                    mediaElement.style.transition = 'all 0.3s ease-in-out';
                    mediaElement.src = previewUrl; // Use preview URL for initial loading
                    mediaElement.style.animation = 'fade-in 500ms forwards';
    				mediaElement.style.animationDelay = 'calc(0.1s * var(--))';
                    // mediaElement.setAttribute('data-src', tempLinkData.link); // Set temp link for lazy loading
                    // mediaElement.setAttribute('loading', 'lazy');
                    // mediaElement.style.maxWidth = '100%';
                    } else if (['mp4', 'mov', 'avi', 'mkv'].includes(fileExtension)) {
                    mediaElement = document.createElement('video');
                    // mediaElement.dataset.src = tempLinkData.link;
                    mediaElement.style.transition = 'all 0.3s ease-in-out';
                    mediaElement.src = previewUrl; // Use preview URL for initial loading
                    // mediaElement.setAttribute('data-src', tempLinkData.link); // Set temp link for lazy loading
                    // mediaElement.setAttribute('loading', 'lazy');
                    mediaElement.controls = true;
                    mediaElement.style.animation = 'fade-in 500ms forwards';
    				mediaElement.style.animationDelay = 'calc(0.1s * var(--))';
                    // mediaElement.style.maxWidth = '100%';
                    }
                    if (mediaElement) {
                    const wrapper = document.createElement('div');
                    wrapper.style.position = 'relative';
                    wrapper.style.display = 'inline-block';
                    wrapper.appendChild(mediaElement);
                    container.appendChild(wrapper);
                    // Increment the startIndex each time an element is added
                    startIndex++;
                    }
                } else {
                    console.error('Error getting temporary link:', tempLinkResponse.statusText);
                }
                } catch (error) {
                console.error('Error fetching temporary link:', error);
                }
            }
        }
    }
}
function appendLoadMoreButton() {
    const loadMoreButton = document.getElementById('load-more-button');
    loadMoreButton.style.display = 'flex';
    loadMoreButton.onclick = () => {
      startIndex = 0; // Reset the startIndex counter to 0 when the button is clicked
      loadMoreButton.style.display = 'none'; // Hide the button after clicking
      loadMoreFiles(); // Load more files
    };
  }
// Handle loading more files
async function loadMoreFiles() {
    const results = await searchDropboxFiles(startIndex);
    await appendResults(results);
}
// listeners
document.addEventListener('DOMContentLoaded', async function () {
    // remove admin button listener
    const removeAdminButton = document.getElementById('remove-admin-button');
    if (removeAdminButton) {
        removeAdminButton.addEventListener('click', handleRemoveAdmin);
    }
    //change password listener
    const changePasswordForm = document.getElementsByClassName('change-password-form');
    if (changePasswordForm.length > 0) {
        for (let i = 0; i < changePasswordForm.length; i++) {
            changePasswordForm[i].addEventListener('submit', handleChangePassword, true);
        }
    }
    // forgot password form listsneer
    const forgotPasswordForm = document.getElementById('forgot-password-form');
    if (forgotPasswordForm) {
        forgotPasswordForm.addEventListener('submit', handleForgotPassword, true);
    }
    // upload button listener
    const uploadButton = document.getElementById('uploadButton');
    if (uploadButton) {
        uploadButton.addEventListener('click', uploadImage);
    }
    // assign admin button listener
    const assignAdminButton = document.getElementById('assign-admin-button');
    if (assignAdminButton) {
        assignAdminButton.addEventListener('click', handleAssignAdmin);
    }
    // change email listener
    const changeEmailForm = document.getElementById('change-email-form');
    if (changeEmailForm) {
        changeEmailForm.addEventListener('submit', handleChangeEmail, true);
    }
})
// Initialize by loading the first set of files
loadMoreFiles();
// Add "Load More" button in a wrapper dynamically
const loadMoreWrapper = document.getElementById('load-more-wrapper');
const loadMoreButton = document.createElement('button');
loadMoreButton.id = 'load-more-button';
loadMoreButton.innerText = 'Load More';
loadMoreButton.style.display = 'none';
loadMoreButton.addEventListener('click', loadMoreFiles);
loadMoreWrapper.appendChild(loadMoreButton);
// Identify auth action forms
let signUpForm = document.getElementById('wf-form-signup-form');
let signInForm = document.getElementById('wf-form-signin-form');
let signOutButton = document.getElementById('signout-button');
// Assign event listeners if the elements exist
if (signUpForm) signUpForm.addEventListener('submit', handleSignUp, true);
if (signInForm) signInForm.addEventListener('submit', handleSignIn, true);
if (signOutButton) signOutButton.addEventListener('click', handleSignOut);
</script>
</head>
<body>
  <section class="admin-page">
    <div class="custom-css w-embed">
      <style>
 /*scroll width*/
 .middle::-webkit-scrollbar {
 width:5px;
 }
 /*scroll track*/
 .middle::-webkit-scrollbar-track {
 background:rgb(243, 243, 243);
 }
 /*scroll thumb*/
 .middle::-webkit-scrollbar-thumb {
 background:rgb(215, 214, 214);
 border-radius:1000px;
 }
</style>
    </div>
    <div class="admin-contents">
      <div class="left-nav">
        <div class="nav-spacer"></div>
        <div data-w-id="5d6164c5-01f1-69e0-4884-55763a3740a7" class="navigation">
          <div class="nav-top">
            <a href="#" class="logo-link w-inline-block"><img src="images/t-logo.svg" loading="lazy" alt="" class="logo-img"></a>
            <div class="border tablet-hide"></div>
            <div class="left-nav__menu">
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="21" height="21" viewbox="0 0 21 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_15)">
                      <path d="M19.3118 14.924V6.56684C19.3111 6.44612 19.276 6.32771 19.2099 6.22355C19.1438 6.11938 19.0492 6.03315 18.9355 5.97353L10.8586 1.77803C10.7498 1.72 10.6263 1.68945 10.5006 1.68945C10.375 1.68945 10.2515 1.72 10.1427 1.77803L2.06576 5.97353C1.95209 6.03315 1.85745 6.11938 1.79138 6.22355C1.72531 6.32771 1.69016 6.44612 1.68945 6.56684V14.924C1.69016 15.0447 1.72531 15.1631 1.79138 15.2672C1.85745 15.3714 1.95209 15.4576 2.06576 15.5173L10.1427 19.7128C10.2515 19.7708 10.375 19.8013 10.5006 19.8013C10.6263 19.8013 10.7498 19.7708 10.8586 19.7128L18.9355 15.5173C19.0492 15.4576 19.1438 15.3714 19.2099 15.2672C19.276 15.1631 19.3111 15.0447 19.3118 14.924V14.924Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M19.1891 6.2168L10.5827 10.7448L1.81152 6.2168" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M10.6224 10.7451L10.5 19.8011" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_15">
                        <rect width="21" height="21" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="22" height="23" viewbox="0 0 22 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_20)">
                      <path d="M17.2672 4.50879H1.73185C1.30285 4.50879 0.955078 4.85656 0.955078 5.28556V20.8209C0.955078 21.2499 1.30285 21.5977 1.73185 21.5977H17.2672C17.6962 21.5977 18.044 21.2499 18.044 20.8209V5.28556C18.044 4.85656 17.6962 4.50879 17.2672 4.50879Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M14.1602 2.95508V6.06215" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M4.83984 2.95508V6.06215" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M0.955078 9.16895H18.044" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <circle cx="18" cy="4" r="3.5" fill="#BA5066" stroke="white"></circle>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_20">
                        <rect width="22" height="23" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="23" height="23" viewbox="0 0 23 23" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_43)">
                      <path d="M6.39127 18.5379L3.13021 21.2639C3.01254 21.3612 2.86968 21.4233 2.71819 21.4427C2.5667 21.4622 2.41279 21.4383 2.27433 21.3738C2.13588 21.3093 2.01854 21.2069 1.93593 21.0785C1.85332 20.95 1.80883 20.8007 1.80762 20.648V4.61531C1.80762 4.4011 1.89271 4.19566 2.04418 4.04418C2.19566 3.89271 2.4011 3.80762 2.61531 3.80762H20.3845C20.5988 3.80762 20.8042 3.89271 20.9557 4.04418C21.1071 4.19566 21.1922 4.4011 21.1922 4.61531V17.5384C21.1922 17.7526 21.1071 17.958 20.9557 18.1095C20.8042 18.261 20.5988 18.3461 20.3845 18.3461H6.90617C6.71708 18.3461 6.53431 18.4142 6.39127 18.5379V18.5379Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M11.4996 12.2883C12.1687 12.2883 12.7112 11.7459 12.7112 11.0768C12.7112 10.4077 12.1687 9.86523 11.4996 9.86523C10.8305 9.86523 10.2881 10.4077 10.2881 11.0768C10.2881 11.7459 10.8305 12.2883 11.4996 12.2883Z" fill="currentColor"></path>
                      <path d="M6.65392 12.2883C7.32304 12.2883 7.86546 11.7459 7.86546 11.0768C7.86546 10.4077 7.32304 9.86523 6.65392 9.86523C5.98481 9.86523 5.44238 10.4077 5.44238 11.0768C5.44238 11.7459 5.98481 12.2883 6.65392 12.2883Z" fill="currentColor"></path>
                      <path d="M16.3463 12.2883C17.0154 12.2883 17.5578 11.7459 17.5578 11.0768C17.5578 10.4077 17.0154 9.86523 16.3463 9.86523C15.6772 9.86523 15.1348 10.4077 15.1348 11.0768C15.1348 11.7459 15.6772 12.2883 16.3463 12.2883Z" fill="currentColor"></path>
                      <circle cx="19" cy="4" r="3.5" fill="#BA5066" stroke="white"></circle>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_43">
                        <rect width="23" height="23" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
              <a href="#" class="nav-link__block last w-inline-block">
                <div class="w-embed"><svg width="19" height="21" viewbox="0 0 19 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_50)">
                      <path d="M17.2672 2.50879H1.73185C1.30285 2.50879 0.955078 2.85656 0.955078 3.28556V18.8209C0.955078 19.2499 1.30285 19.5977 1.73185 19.5977H17.2672C17.6962 19.5977 18.044 19.2499 18.044 18.8209V3.28556C18.044 2.85656 17.6962 2.50879 17.2672 2.50879Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M14.1602 0.955078V4.06215" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M4.83984 0.955078V4.06215" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M0.955078 7.16895H18.044" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_50">
                        <rect width="19" height="20.6522" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
            </div>
            <div class="border"></div>
            <div class="left-nav__menu">
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="22" height="22" viewbox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_11)">
                      <path d="M4.40888 17.5909C3.58388 16.7659 4.13089 15.0352 3.70943 14.0219C3.28796 13.0086 1.67383 12.1208 1.67383 10.9999C1.67383 9.87899 3.27002 9.02709 3.70943 7.9779C4.14883 6.92872 3.58388 5.23388 4.40888 4.40888C5.23388 3.58388 6.96459 4.13089 7.9779 3.70943C8.99122 3.28796 9.87899 1.67383 10.9999 1.67383C12.1208 1.67383 12.9727 3.27002 14.0219 3.70943C15.0711 4.14883 16.7659 3.58388 17.5909 4.40888C18.4159 5.23388 17.8689 6.96459 18.2904 7.9779C18.7119 8.99122 20.326 9.87899 20.326 10.9999C20.326 12.1208 18.7298 12.9727 18.2904 14.0219C17.851 15.0711 18.4159 16.7659 17.5909 17.5909C16.7659 18.4159 15.0352 17.8689 14.0219 18.2904C13.0086 18.7119 12.1208 20.326 10.9999 20.326C9.87899 20.326 9.02709 18.7298 7.9779 18.2904C6.92872 17.851 5.23388 18.4159 4.40888 17.5909Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M14.946 8.84766L9.68213 13.8694L7.05469 11.3585" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_11">
                        <rect width="22" height="22" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="19" height="20" viewbox="0 0 19 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g clip-path="url(#clip0_1181_32)">
                      <path d="M0.955078 7.43138V1.73185C0.955078 1.52583 1.03692 1.32826 1.18259 1.18259C1.32826 1.03692 1.52583 0.955078 1.73185 0.955078H17.2672C17.4732 0.955078 17.6708 1.03692 17.8165 1.18259C17.9621 1.32826 18.044 1.52583 18.044 1.73185V7.43138C18.044 15.5875 11.121 18.2867 9.74227 18.7431C9.58564 18.8011 9.41342 18.8011 9.25679 18.7431C7.87803 18.2867 0.955078 15.5875 0.955078 7.43138Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                      <path d="M13.772 6.39355L8.07245 11.8309L5.22754 9.11224" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    </g>
                    <defs>
                      <clippath id="clip0_1181_32">
                        <rect width="19" height="19.8261" fill="white"></rect>
                      </clippath>
                    </defs>
                  </svg></div>
              </a>
              <a href="#" class="nav-link__block w-inline-block">
                <div class="w-embed"><svg width="28" height="20" viewbox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9.39149 13.3064C12.593 13.3064 15.1883 10.6416 15.1883 7.35438C15.1883 4.06716 12.593 1.40234 9.39149 1.40234C6.19003 1.40234 3.59473 4.06716 3.59473 7.35438C3.59473 10.6416 6.19003 13.3064 9.39149 13.3064Z" stroke="currentColor" stroke-width="2" stroke-miterlimit="10"></path>
                    <path d="M16.9053 1.61982C17.4177 1.47712 17.9461 1.404 18.4771 1.40234C20.0145 1.40234 21.4889 2.02943 22.576 3.14565C23.6631 4.26188 24.2739 5.7758 24.2739 7.35438C24.2739 8.93296 23.6631 10.4469 22.576 11.5631C21.4889 12.6793 20.0145 13.3064 18.4771 13.3064" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M1.36621 17.5879C2.27134 16.2654 3.47315 15.186 4.87014 14.4408C6.26713 13.6957 7.81825 13.3066 9.3925 13.3066C10.9667 13.3066 12.5179 13.6957 13.9149 14.4408C15.3118 15.186 16.5137 16.2654 17.4188 17.5879" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                    <path d="M18.4775 13.3066C20.0519 13.3056 21.6034 13.6942 23.0005 14.4393C24.3976 15.1845 25.5993 16.2644 26.5038 17.5875" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                  </svg></div>
              </a>
            </div>
          </div>
          <div class="nav-bot">
            <a href="#" class="circle-link w-inline-block"><img src="images/man_1man.jpg" loading="lazy" alt=""></a>
            <a href="#" class="circle-link w-inline-block"><img src="images/woman_1woman.jpg" loading="lazy" alt=""></a>
            <a href="#" class="circle-link w-inline-block"><img src="images/woman1_1woman1.jpg" loading="lazy" alt=""></a>
            <a href="#" class="circle-link pink w-inline-block"><img src="images/plus.svg" loading="lazy" alt=""></a>
          </div>
        </div>
      </div>
      <div class="grid-2">
        <div id="w-node-_5d6164c5-01f1-69e0-4884-55763a3740c7-37e0359e" class="sticky-nav">
          <a href="#" class="w-inline-block"><img src="images/template-logo.svg" loading="lazy" alt=""></a>
          <div data-w-id="5d6164c5-01f1-69e0-4884-55763a3740ca" class="hamburger">
            <div data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cb" class="hamburger-line top"></div>
            <div data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cc" class="hamburger-line mid"></div>
            <div data-w-id="5d6164c5-01f1-69e0-4884-55763a3740cd" class="hamburger-line bot"></div>
          </div>
        </div>
        <div class="middle">
          <div class="middle-wrap">
            <div class="middle-heading">
              <p class="semi-bold">Adventure Trek</p>
              <div class="form-block-2 w-form">
                <form id="email-form" name="email-form" data-name="Email Form" method="get" class="form-2" data-wf-page-id="65f1d2d24fccf22237e0359e" data-wf-element-id="5d6164c5-01f1-69e0-4884-55763a3740d4"><input class="search w-input" maxlength="256" name="name" data-name="Name" placeholder="Search contacts" type="text" id="name"></form>
                <div class="w-form-done">
                  <div>Thank you! Your submission has been received!</div>
                </div>
                <div class="w-form-fail">
                  <div>Oops! Something went wrong while submitting the form.</div>
                </div>
              </div>
            </div>
            <div class="middle-heading__flex">
              <div>
                <h2 class="mb-20-2">Good Evening Team!</h2>
                <h3>$44,750.00</h3>
              </div>
              <div class="buttons-wrap">
                <a href="#" class="button-4 w-inline-block"><img src="images/chat-brown.svg" loading="lazy" alt="">
                  <p>Send Message</p>
                </a>
                <a href="#" class="button-4 w-inline-block"><img src="images/users-brown.svg" loading="lazy" alt="">
                  <p>Export Contacts</p>
                </a>
              </div>
            </div>
            <div class="summary">
              <div class="summary-block">
                <p class="p-12 text-white">People Going</p>
                <h2 class="h1 margins">274</h2>
                <p class="summary-light">24% More People Than Last Trip with same iternary</p>
              </div>
              <div id="w-node-_5d6164c5-01f1-69e0-4884-55763a3740f3-37e0359e" class="summary-border"></div>
              <div class="summary-block">
                <p class="p-12 text-white">Destinations Covered</p>
                <h2 class="h1 margins">12</h2>
                <p class="summary-light">12 places to visit in 7 days trip iternary</p>
              </div>
              <div id="w-node-_5d6164c5-01f1-69e0-4884-55763a3740fb-37e0359e" class="summary-border"></div>
              <div class="summary-block">
                <p class="p-12 text-white">People Interested</p>
                <h2 class="h1 margins">540</h2>
                <p class="summary-light">540 shoed interest in going for this trip</p>
              </div>
            </div>
            <div class="stats">
              <div class="stats-top">
                <div class="stat-top__card">
                  <div class="stat-top__l"><img src="images/arrow-top.svg" loading="lazy" alt=""></div>
                  <div class="stat-top__r">
                    <p class="p-12 text-light">People Interested</p>
                    <p class="mt-10">45,312</p>
                  </div>
                </div>
                <div class="stat-top__card">
                  <div class="stat-top__l yellow"><img src="images/arrow-bot.svg" loading="lazy" alt=""></div>
                  <div class="stat-top__r">
                    <p class="p-12 text-light">People Booked</p>
                    <p class="mt-10">9,857</p>
                  </div>
                </div>
                <div class="stat-top__card">
                  <div class="stat-top__l gren"><img src="images/hourglass.svg" loading="lazy" alt=""></div>
                  <div class="stat-top__r">
                    <p class="p-12 text-light">People Waiting</p>
                    <p class="mt-10">4,221</p>
                  </div>
                </div>
              </div>
              <div class="stats-bot">
                <div class="stat-bot__card">
                  <div class="stat-bot__l"><img src="images/lightning.svg" loading="lazy" alt=""></div>
                  <div class="stat-bot__r">
                    <p class="stat-bot__h">This Week</p>
                    <div class="stat-bot__flex">
                      <h3>1,432</h3><img src="images/arrow-green.svg" loading="lazy" alt="">
                    </div>
                    <p class="p-13">+6.4%</p>
                  </div>
                </div>
                <div class="stat-bot__card">
                  <div class="stat-bot__l pink"><img src="images/arrow-angle.svg" loading="lazy" alt=""></div>
                  <div class="stat-bot__r">
                    <p class="stat-bot__h">This Month</p>
                    <div class="stat-bot__flex">
                      <h3>3,200</h3><img src="images/arrow-red.svg" loading="lazy" alt="">
                    </div>
                    <p class="p-13">-3.1%</p>
                  </div>
                </div>
                <div class="stat-bot__card">
                  <div class="stat-bot__l green"><img src="images/clock.svg" loading="lazy" alt=""></div>
                  <div class="stat-bot__r">
                    <p class="stat-bot__h">Upcoming</p>
                    <div class="stat-bot__flex">
                      <h3>4,500</h3><img src="images/arrow-red.svg" loading="lazy" alt="">
                    </div>
                    <p class="p-13">+10.3%</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div data-w-id="5d6164c5-01f1-69e0-4884-55763a374142" class="right-nav">
          <div class="nav-right__heading">
            <a href="#" class="icon-link w-inline-block"><img src="images/chats.svg" loading="lazy" alt=""></a>
            <a href="#" class="icon-link w-inline-block"><img src="images/notification.svg" loading="lazy" alt=""></a>
            <a href="#" class="icon-link w-inline-block"><img src="images/box.svg" loading="lazy" alt=""></a>
            <a href="#" class="icon-link round w-inline-block"><img src="images/man1_1man1.jpg" loading="lazy" alt=""></a>
          </div>
          <div class="heading-wrap">
            <div class="heading-flex">
              <div class="heading-flex__l">
                <div class="circle-small"><img src="images/clip.svg" loading="lazy" alt=""></div>
                <p class="p-12">5 Days Trips</p>
              </div>
              <div data-hover="false" data-delay="0" class="dropdown w-dropdown">
                <div class="dd-toggle w-dropdown-toggle">
                  <p class="dd-p">Trip 12</p><img src="images/dd-arrow.svg" loading="lazy" alt="" class="dd-icon">
                </div>
                <nav class="dd-list w-dropdown-list">
                  <a href="#" class="dd-link w-dropdown-link">Trip 11</a>
                  <a href="#" class="dd-link w-dropdown-link">Trip 10</a>
                  <a href="#" class="dd-link w-dropdown-link">Trip 9</a>
                  <a href="#" class="dd-link w-dropdown-link">Trip 8</a>
                </nav>
              </div>
            </div>
            <h1>5 days to trip to Sakrdu and Kumrat Valley</h1>
            <div class="name-wrap">
              <div class="circle-small name">
                <p>JD</p>
              </div>
              <p class="p-12">John Doe</p>
            </div>
            <div class="members-wrap">
              <p class="p-15">27 people going to this trip</p>
              <div class="members-flex"><img src="images/woman1_1woman1.jpg" loading="lazy" alt="" class="image-circle"><img src="images/man_1man.jpg" loading="lazy" alt="" class="image-circle white"><img src="images/woman_1woman.jpg" loading="lazy" alt="" class="image-circle pink"><img src="images/man1_1man1.jpg" loading="lazy" alt="" class="image-circle">
                <div class="more-members">
                  <p>23+</p>
                </div>
              </div>
            </div>
            <div class="date-wrap">
              <div class="date-l">
                <div class="date-square">
                  <div class="date-square small"><img src="images/compass.svg" loading="lazy" alt=""></div>
                </div>
                <div class="date-info">
                  <p class="date-h">Sunday , 31st October 2021</p>
                  <p>08:00 - 11:00 AM</p>
                </div>
              </div><img src="images/pen.svg" loading="lazy" alt="" class="edit">
            </div>
          </div><img src="images/camp.svg" loading="lazy" alt="" class="right-nav__img">
        </div>
      </div>
    </div>
    <div data-w-id="5d6164c5-01f1-69e0-4884-55763a374180" class="nav-shadow"></div>
  </section>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=65ef6a9d933d09fb8c604750" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <!--  Carousel for family  -->
  <script>
        const leftArrow = document.getElementById('left-arrow');
        const rightArrow = document.getElementById('right-arrow');
        const years = document.querySelector('.years');
        let index = 0;
        function showSlide(newIndex) {
            const items = document.querySelectorAll('.year-item');
            if (newIndex < 0) {
                index = items.length - 1;
            } else if (newIndex >= items.length) {
                index = 0;
            } else {
                index = newIndex;
            }
            years.style.transform = `translateX(-${index * 100}%)`;
        }
        leftArrow.addEventListener('click', () => {
            showSlide(index - 1);
        });
        rightArrow.addEventListener('click', () => {
            showSlide(index + 1);
        });
        setInterval(() => {
            showSlide(index + 1);
        }, 4000);
    </script>
  <script>
        // This script prints a custom message to the browser console
        (function() {
            console.log('%cCreated by WebRend and Kevin Vera', 'color: green; font-size: 20px; font-weight: bold;');
        })();
    </script>
  <!--  SCROLLBAR CSS  -->
  <style>
/* For WebKit browsers (Chrome, Safari) */
::-webkit-scrollbar {
  width: 12px; /* Adjust the width of the scrollbar */
}
::-webkit-scrollbar-track {
  background: #000; /* Black background for the track */
}
::-webkit-scrollbar-thumb {
  background: #333; /* Dark grey for the thumb */
  border-radius: 10px; /* Rounded corners for the thumb */
}
::-webkit-scrollbar-thumb:hover {
  background: #555; /* Slightly lighter grey when hovered */
}
/* For Firefox */
html {
  scrollbar-width: thin; /* Make the scrollbar thin */
  scrollbar-color: #333 #000; /* Thumb color, Track color */
}
/* For Internet Explorer and Edge */
* {
  scrollbar-color: #333 #000; /* Thumb color, Track color */
  scrollbar-width: thin; /* Make the scrollbar thin */
}
</style>
</body>
</html>